import {Alert} from 'theme-ui';
import {Hooks} from '../content';
import './highlighting.css';

<Alert sx={{mt: 3}} variant="callout">
  ðŸš§ Pardon our dust, these docs are currently under construction ðŸš§
</Alert>

# gatsby-theme-shopify-manager

> The easiest way to start a Shopify shop on Gatsby.

Gatsby-theme-shopify-manager is an opinionated Gatsby theme that does the heavy lifting for you in setting up a Shopify store on Gatsby. It provides a foundation to build a fast Shopify shop on top of.

> Want to see this in action? _This page_ is a working example, as well as documentation. Read on to see it!

## Getting Started

To start using the theme, install it with your package manager of choice:

```bash
yarn add gatsby-theme-shopify-manager
```

To start using it, open your `gatsby-config` file and include your Shop name and access token from the Storefront API.

```javascript
{
  resolve: `gatsby-theme-shopify-manager`,
  options: {
    shopName: 'your shop name',
    accessToken: 'your storefront API access token',
  },
},
```

When you use this theme, it automatically includes `gatsby-source-shopify` and sets it up for you. These options are passed to that package, as well as used internally to create a connection to Shopify using [shopify-buy](https://shopify.github.io/js-buy-sdk/).

### Configuration options

| key         | required | description                                                                                                                    |
| ----------- | -------- | ------------------------------------------------------------------------------------------------------------------------------ |
| shopName    | yes      | This is the first part of the default Shopify domain. If your domain is my-store.myshopify.com, the shopName would be my-shop. |
| accessToken | yes      | This is the Storefront API token that you get when you make a new Shopify app.                                                 |

## Context Provider

The Shopify buy client and current cart state are managed using React context. By default, the application is wrapped by the Provider and the `shopName` and `accessToken` are pulled from the config options and passed to it. However, in some cases, it might be preferable to manage the provider.

To use the provider, import it and pass `shopName` and `accessToken` to it as props.

```javascript
import React from 'react';
import {ContextProvider} from 'gatsby-theme-shopify-manager';
export const App = ({children}) => {
  const shopName = 'some-shop-name';
  const accessToken = 'some-access-token';

  return (
    <ContextProvider shopName={shopName} accessToken={accessToken}>
      {children}
    </ContextProvider>
  );
};
```

## Hooks

The main export of this package are the hooks that you can use. Here are the hooks you can use:

<Hooks />

## Escape Hooks

In addition to the normal hooks, there are two 'escape' hooks. These hooks allow access to setting the cart state and the client object that is used to interact with Shopify. It's important to note that these are considered experiementalâ€“**using these hooks may result in unintended side-effects.**

### useClientUnsafe

The `useClientUnsafe` hook returns the client object currently held in the context. From there you can call methods on it to enable more functionality. Shopify has all [the documentation](https://shopify.github.io/js-buy-sdk/) for what you can do with the client object. Example usage:

```javascript
import React from 'react';
import {useClientUnsafe} from 'gatsby-theme-shopify-manager';

export function ExampleUseClientUnsafe() {
  const client = useClientUnsafe();
  // do work with the client here
}
```

### useSetCartUnsafe

The `useSetCartUnsafe` returns a function that allows the user to set the current cart state. You can use it similar to the function returned from a `useState` destructure. This is useful for interactions with the `client` object that return an updated cart object. Example usage:

```javascript
import React from 'react';
import {useClientUnsafe, useSetCartUnsafe} from 'gatsby-theme-shopify-manager';

export function ExampleUseSetCartUnsafe() {
  const client = useClientUnsafe();
  const setCart = useSetCartUnsafe();

  async function changeCart() {
    const newCart = await client.doSomeMethodThatReturnsACartObject();
    setCart(newCart);
  }

  changeCart();
}
```
